/*! tjzx.ued version:0.1.0 2014-05-10 09:49:49 */
!function($,f,u){var valid={rules:{require:/[\w\W]+/,mobile:/^1[3458][0-9]{9}$/,email:/^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,url:/^(\w+:\/\/)?\w+(\.\w+)+.*$/,ip:/^(((25[0-5])|(2[0-4]\d)|(1\d{2})|([1-9]?\d))\.){3}((25[0-5])|(2[0-4]\d)|(1\d{2})|([1-9]?\d))$/,number:/^\d+$/},rulesMsg:{require:"不能为空！",mobile:"请填写手机号码！",email:"请填写邮箱！",url:"请填写网址！",ip:"请输入正确的IP地址！",number:"请填写数字！"},getValue:function(a){var b,c=this;return a.is(":radio")?b=c.find(":radio[name='"+a.attr("name")+"']:checked").val():a.is(":checkbox")?(b="",c.find(":checkbox[name='"+a.attr("name")+"']:checked").each(function(){b+=$(this).val()+","})):b=a.val(),b=b===u?"":b,$.trim(b)},setValue:function(a,b){var c,d,e,f=this;if(e=f.find('[name="'+a+'"]').eq(0),e.is(":radio")){if(d=f.find(":radio[name='"+a+"']"),""===b)return d.each(function(){this.checked=!1}),!1;for(var g=0;g<d.length;g++){c=d.eq(g);var h=c.val();if(h===b||!isNaN(h)&&~~h===b){c.get(0).checked=!0;break}}}else if(e.is(":checkbox")){var i=[];if(b&&"string"==typeof b?i=b.split(","):isNaN(b)||i.push(b),$.isArray(b)&&(i=b),d=f.find(":checkbox[name='"+a+"']"),""===b)return d.each(function(){this.checked=!1}),!1;d.each(function(){c=$(this);var a=c.val(),b=$.inArray(a,i)>=0||!isNaN(a)&&$.inArray(~~a,i)>=0;c[0].checked=b})}else if(e.is("select")){d=f.find("select[name='"+a+"'] option"),b=b.toString();for(var g=0;g<d.length;g++)if(c=d.eq(g),b===c.val()){c.get(0).selected=!0;break}}else d=f.find('[name="'+a+'"]'),d.val(b)||d.text(b)},check:function(form){var $t=$(this),ps=$(form).data("valid"),opt=$t.data("rule");if(!opt)return!0;"string"==typeof opt&&(opt=eval("("+opt+")"));var rule=ps.rules[opt.type]||new RegExp(opt.type,"gi"),value=valid.getValue.call(form,$t),$tip=opt.tip?$(opt.tip):$t.siblings(".m-form-tip");if($tip&&1==$tip.length||($t.parent().append("<span class='m-form-tip'></span>"),$tip=$t.siblings(".m-form-tip")),!rule.test(value)){var msg=opt.msg||ps.rulesMsg[opt.type]||"输入错误！";return $t.addClass("control-error"),$tip.removeClass("valid-success").addClass("valid-error").html(msg),$(form).data("focus")||($t.focus(),$(form).data("focus",!f)),!1}return $t.removeClass("control-error"),$tip.removeClass("valid-error").addClass("valid-success").html(""),!0}},validForm=function(forms,options){var opts=$.extend({rules:valid.rules,rulesMsg:valid.rulesMsg,submit:f},options||{}),$forms=this.forms=$(forms);return $.each(this.forms,function(i){var $form=$forms.eq(i),optionData=$form.data("form")||$form.attr("data-form"),ps=$.extend({},opts);optionData&&"string"==typeof optionData&&(optionData=eval("("+optionData+")")),optionData&&"object"==typeof optionData&&(ps=$.extend(ps,optionData)),$form.data("valid",ps);var $inputs=$form.find("[data-valid]");$inputs.each(function(){$(this).data("rule",$(this).data("valid")||$(this).attr("data-valid"))}),$form.find("[name]").bind("blur",function(){$(this).data("rule")&&valid.check.call(this,$form)}),$form.find("[key-submit]").bind("keyup",function(a){13===a.keyCode&&ps.submit&&"function"==typeof ps.submit&&ps.submit.call(this)})}),this};validForm.prototype={check:function(){var a=!f,b=this.forms;return b.each(function(c){var d=b.eq(c);d.data("focus",f),d.find("[name]").each(function(){valid.check.call(this,d)||(a=f)})}),a},json:function(a){var b=this.forms.eq(a||0),c={};return $.each(b.find("[name]"),function(){c.hasOwnProperty(this.name)||(c[this.name]=valid.getValue.call(b,$(this)))}),c},serialize:function(a){var b=this.json(a),c=[];for(var d in b)c.push(d+"="+encodeURI(b[d]));return c.join("&")},bind:function(a,b){var c=this.forms.eq(b||0);if(c.find(".control-error").removeClass("control-error"),c.find(".m-form-tip").remove(),"object"!=typeof a)return this.reset(b),!1;for(var d in a)a.hasOwnProperty(d)&&valid.setValue.call(c,d,a[d])},init:function(){for(var a=0;a<this.forms.length;a++){var b=this.forms.eq(a);b.data("init")||b.data("init",this.json(a))}},reset:function(a){var b=this.forms.eq(a||0);b.find(".m-form-tip").remove(),b.find(".control-error").removeClass("control-error"),this.bind(b.data("init"),a)}},$.fn.extend({valid:function(a){return new validForm(this,a)}})}(jQuery,!1,void 0);