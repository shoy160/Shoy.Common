/*! tjzx.ued version:0.1.0 2014-05-10 09:49:49 */
var Dialog=window.Dialog=function(a){var b=window.artDialog(a);return a.modal?b.showModal():a.element?b.show(a.element):b.show(),b},call=function(a){a&&"function"==typeof a&&a.call(this)},Alert=window.Alert=function(a,b){var c={title:"操作提示",content:a,padding:20,okValue:"确认",ok:!0,onclose:function(){call(b)},modal:!0};Dialog(c)},Confirm=window.Confirm=function(a,b,c){var d={title:"操作提示",content:a,padding:20,okValue:"确认",ok:function(){call(b)},cancelValue:"取消",cancel:function(){call(c)},modal:!0};Dialog(d)},callback=window.CALLBACK=function(a){return!a||a.state<1?(Alert(a.msg||"操作异常！",function(){-1==a.state&&(location.href="/m/login?return_url="+encodeURIComponent(location.href))}),!1):!0},loadDialog;!function(a,b){var c=new hTemplate({tmp:a("#h-topMenu").html(),container:a(".m-nav ul"),empty:""}),d=new hTemplate({tmp:a("#h-menu").html(),container:a(".m-menus ul"),empty:""}),e=function(d){return b.isArray(d)&&d.length?(d[0].active=' class="active"',c.bind(d),a(".m-nav li:eq(0)").click(),!0):!1},f=function(c){return b.isArray(c)&&c.length?(d.bind(c),a(".m-menus li:eq(0)").click(),!0):!1},g=function(){var c=a(".m-nav li a.active"),d=a(".m-menus li a.active"),e=a(".m-crumbs");e.find("dd").remove(),e.append(b.format('<dd><a href="#" data-id="{id}">{text}</a></dd>',{id:c.parent().data("id"),text:c.html().replace(/<[^>]+>[^<]*<\/[^>]+>/gi,"")})),e.append(b.format('<dd class="active">{text}</dd>',{text:d.html().replace(/<[^>]+>[^<]*<\/[^>]+>/gi,"")}))},h=function(c){a.ajax({url:"/m/menus",type:"post",dataType:"json",data:{parentId:c,t:Math.random()},success:function(a){return callback(a)?void(b.isArray(a)&&a.length&&(0==c?e(a):f(a))):!1},error:function(a){console.log(a),Alert("加载异常..！")}})};h(0),a(".m-nav,.m-menus").delegate("li","click",function(){var b=a(this).find(">a");if(!a(this).data("id")&&b.hasClass("active"))return!1;b.addClass("active"),a(this).siblings("li").find(">a").removeClass("active");var c=~~a(this).data("id");if(c&&c>0)h(c);else{var d=b.attr("href");frameLoad(d),g()}return!1}),a(".m-crumbs").delegate("a","click",function(){var b=a(this).data("id");return b&&a(".m-nav li[data-id='"+b+"']").click(),!1})}(jQuery,SINGER);var setFrameHeight=window.SetFrameHeight=function(){var a=1200,b=$("#framePage");try{a=b.contents().find("body").height()}catch(c){}b.css("height",a+20),loadDialog&&loadDialog.close().remove()},frameLoad=function(a){a||window.frames.framePage.location.reload(),$("#framePage").attr("src",a),loadDialog=Dialog({modal:!0})};$("#framePage").load(function(){setFrameHeight(),loadDialog&&loadDialog.close().remove()});